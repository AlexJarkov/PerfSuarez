<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    <title>ARMA TU COMBO!!!</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="icon" sizes="16x16 32x32 48x48" href="../PerfSuarez/imagenes/Cowboy.ico" type="image/x-icon">
    <link rel="icon" sizes="16x16 32x32 48x48" href="../PerfSuarez/imagenes/Cowboy.webp" type="image/webp">
    <meta property="og:title" content="Arma Tu Combo">
    <meta property="og:description" content="Nuestra más reciente novedad: Arma Tu Combo!!.">
    <meta property="og:image" content="https://www.perfumeriasuarez.com/imagenes/miniatura.JPEG">
    <meta property="og:url" content="https://perfumeriasuarez.com/armarcombo.html">
    <meta property="og:type" content="website">
</head>

<body>
    <div data-include="../header.html"></div>
    <main>
        <section id="combos-personalizados">
            <div class="container">
                <h2>Combos Personalizados</h2>
                <div class="combo-type-selection">
                    <label for="combo-type">Selecciona el tipo de combo:</label>
                    <select id="combo-type" onchange="toggleComboType()">
                        <option value="perfumes">Perfumes Completos</option>
                        <option value="decants">Set de Decants</option>
                    </select>
                </div>
                <div id="decant-quantity-container" class="hidden">
                    <label for="decant-quantity">Selecciona la cantidad de decants:</label>
                    <select id="decant-quantity" onchange="populateComboItems()">
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                    </select>
                </div>
                

                <div class="combo-container">
                    <div id="combo-items"></div>
                    <div id="gift-selection" class="combo-item hidden">
                        <div class="combo-selection">
                            <img src="imagenes/depositphotos_82350542-stock-photo-beautiful-gold-present-box-with.jpg"
                                alt="Regalo" id="gift-image">
                            <h3>Regalo</h3>
                            <p id="gift-name"></p>
                            <button class="dropdown-toggle" data-category="gift"
                                onclick="toggleDropdown('gift')">Seleccionar Regalo</button>
                            <select id="gift-select" hidden></select>
                            <div id="gift-dropdown" class="dropdown"></div>
                        </div>
                    </div>
                </div>

                <div class="total">
                    <p id="savings" style="color: green;">Estás ahorrando: 0.00</p>
                    <h3>Total: <span id="total-price">0.00</span></h3>
                </div>
                <div class="whatsapp-button">
                    <a id="whatsapp-link" class="disabled" href="javascript:void(0);">Selecciona tres perfumes y el
                        regalo para
                        continuar</a>
                </div>
            </div>
        </section>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const whatsappLink = document.getElementById('whatsapp-link');
            const comboTypeSelect = document.getElementById('combo-type');
            const decantQuantityContainer = document.getElementById('decant-quantity-container');
            const comboItemsContainer = document.getElementById('combo-items');
            const giftSelection = document.getElementById('gift-selection');
            let currentCurrency = 'usd'; // Moneda actual (usd o bs)
            const exchangeRate = 7; // Tipo de cambio fijo para convertir a bolivianos

            const products = {
                perfumes: [
                    { name: 'K By Dolce&Gabbana EDT 100ml', image: 'imagenes/fotos-catalogo/d&g/30494500000.png', price: 110, discountedPrice: 87 },
                    // Otros perfumes...
                ],
                decants: [
                    { name: 'K By Dolce&Gabbana Decant 5ml', image: 'imagenes/fotos-catalogo/d&g/30494500000.png', price: 15, discountedPrice: 12 },
                    // Otros decants...
                ],
                gifts: [
                    { name: 'Waka', image: 'imagenes/soproPA600_fa505239-c929-4b5a-af51-d47d3b311967_1024x1024@2x.webp', price: 0, discountedPrice: 0 },
                    // Otros regalos...
                ]
            };

            function toggleComboType() {
                const comboType = comboTypeSelect.value;

                if (comboType === 'decants') {
                    // Mostrar la cantidad de decants y ocultar la selección de regalos
                    decantQuantityContainer.classList.remove('hidden');
                    giftSelection.classList.add('hidden');
                    currentCurrency = 'bs'; // Cambiar moneda a bolivianos
                } else {
                    // Ocultar la cantidad de decants y mostrar la selección de regalos
                    decantQuantityContainer.classList.add('hidden');
                    giftSelection.classList.remove('hidden');
                    currentCurrency = 'usd'; // Cambiar moneda a dólares
                }

                // Actualizar el total con la nueva moneda y poblar los elementos del combo
                populateComboItems();
                updateTotal();
            }


            function populateComboItems() {
                comboItemsContainer.innerHTML = '';
                const comboType = comboTypeSelect.value;
                const productsList = products[comboType];
                let count = comboType === 'decants' ? parseInt(document.getElementById('decant-quantity').value) : 3;
                count = isNaN(count) ? 3 : count;
                for (let i = 0; i < count; i++) {
                    comboItemsContainer.appendChild(createComboItem(comboType, i));
                }
            }

            function createComboItem(category, index) {
                const comboItem = document.createElement('div');
                comboItem.className = 'combo-item';
                const comboSelection = document.createElement('div');
                comboSelection.className = 'combo-selection';

                const image = document.createElement('img');
                image.src = 'imagenes/image.webp';
                image.alt = `${category} producto`;
                image.id = `${category}-image-${index}`;

                const name = document.createElement('p');
                name.id = `${category}-name-${index}`;

                const button = document.createElement('button');
                button.className = 'dropdown-toggle';
                button.dataset.category = category;
                button.dataset.index = index;
                button.onclick = () => toggleDropdown(category, index);
                button.innerText = 'Seleccionar Producto';

                const selectElement = document.createElement('select');
                selectElement.id = `${category}-select-${index}`;
                selectElement.hidden = true;

                const dropdown = document.createElement('div');
                dropdown.className = 'dropdown';
                dropdown.id = `${category}-dropdown-${index}`;

                comboSelection.appendChild(image);
                comboSelection.appendChild(name);
                comboSelection.appendChild(button);
                comboSelection.appendChild(selectElement);
                comboSelection.appendChild(dropdown);
                comboItem.appendChild(comboSelection);

                return comboItem;
            }

            function toggleDropdown(category, index) {
                closeAllDropdowns();
                const dropdown = document.getElementById(`${category}-dropdown-${index}`);
                if (dropdown) {
                    dropdown.classList.toggle('show');
                }
            }

            function closeAllDropdowns() {
                const dropdowns = document.querySelectorAll('.dropdown');
                dropdowns.forEach(dropdown => {
                    dropdown.classList.remove('show');
                });
            }

            function updateTotal() {
                let total = 0;
                let originalTotal = 0;
                let selectedCount = 0;

                ['perfumes', 'decants', 'gifts'].forEach(category => {
                    const selectElements = document.querySelectorAll(`[id^="${category}-select"]`);
                    selectElements.forEach(selectElement => {
                        if (selectElement && selectElement.options.length > 0) {
                            const selectedOption = selectElement.options[selectElement.selectedIndex];
                            const price = parseFloat(selectedOption.getAttribute('data-price'));
                            const discountedPrice = parseFloat(selectedOption.getAttribute('data-discounted-price'));
                            if (!isNaN(discountedPrice)) {
                                total += discountedPrice;
                                originalTotal += price;
                                selectedCount++;
                            }
                        }
                    });
                });

                const savings = originalTotal - total;
                const totalPriceElement = document.getElementById('total-price');
                const savingsElement = document.getElementById('savings');

                if (currentCurrency === 'usd') {
                    totalPriceElement.innerText = `$${total.toFixed(2)}`;
                    savingsElement.innerText = `Estás ahorrando: $${savings.toFixed(2)}`;
                } else {
                    const totalBs = total * exchangeRate;
                    const savingsBs = savings * exchangeRate;
                    totalPriceElement.innerText = `Bs ${totalBs.toFixed(2)}`;
                    savingsElement.innerText = `Estás ahorrando: Bs ${savingsBs.toFixed(2)}`;
                }

                whatsappCount(selectedCount, total);
            }

            function whatsappCount(selectedCount, total) {
                if (selectedCount >= 3) {
                    whatsappLink.classList.remove('disabled');
                    whatsappLink.innerText = 'Ordenar por WhatsApp';
                    updateWhatsAppLink(total);
                } else {
                    whatsappLink.classList.add('disabled');
                    whatsappLink.innerText = 'Selecciona tus productos para continuar';
                    whatsappLink.removeAttribute('href');
                }
            }

            function updateWhatsAppLink(total) {
                const comboType = comboTypeSelect.value;
                const totalPrice = currentCurrency === 'usd' ? `$${total.toFixed(2)}` : `Bs ${(total * exchangeRate).toFixed(2)}`;

                const message = `Hola, me gustaría ordenar el combo personalizado con los siguientes productos:
- Tipo de combo: ${comboType === 'perfumes' ? 'Perfumes Completos' : 'Set de Decants'}
- Precio Total: ${totalPrice}`;

                whatsappLink.href = `https://wa.me/78064327?text=${encodeURIComponent(message)}`;
            }

            document.addEventListener('click', (event) => {
                if (!event.target.classList.contains('dropdown-toggle')) {
                    closeAllDropdowns();
                }
            });

            // Inicializar la interfaz con el combo seleccionado por defecto
            toggleComboType();
        });


    </script>
    <div data-include="footer.html">
    </div>
    <script src="js/scripts.js"></script>
    <script src="js/include.js"></script>
</body>

</html>