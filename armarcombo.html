<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    <title>Perfumería Suárez</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="icon" sizes="16x16 32x32 48x48" href="../PerfSuarez/imagenes/Cowboy.ico" type="image/x-icon">
    <link rel="icon" sizes="16x16 32x32 48x48" href="../PerfSuarez/imagenes/Cowboy.webp" type="image/webp">
</head>

<body>
    <div data-include="../header.html"></div>
    <main>
        <section id="combos-personalizados">
            <div class="container">
                <h2>Combos Personalizados</h2>
                <div class="combo-container">
                    <div class="combo-item">
                        <h3>Perfume de uso diario</h3>
                        <div class="combo-selection">
                            <img src="imagenes/image.webp" alt="Perfume de uso diario" id="daily-image">
                            <p id="daily-name"></p>
                            <button class="dropdown-toggle" data-category="daily"
                                onclick="toggleDropdown('daily')">Seleccionar Perfume</button>
                            <select id="daily-perfume" hidden></select>
                            <div id="daily-dropdown" class="dropdown"></div>
                        </div>
                    </div>
                    <div class="combo-item">
                        <h3>Perfume formal</h3>
                        <div class="combo-selection">
                            <img src="imagenes/image.webp" alt="Perfume formal" id="formal-image">
                            <p id="formal-name"></p>
                            <button class="dropdown-toggle" data-category="formal"
                                onclick="toggleDropdown('formal')">Seleccionar Perfume</button>
                            <select id="formal-perfume" hidden></select>
                            <div id="formal-dropdown" class="dropdown"></div>
                        </div>
                    </div>
                    <div class="combo-item">
                        <h3>Perfume fiestero</h3>
                        <div class="combo-selection">
                            <img src="imagenes/image.webp" alt="Perfume fiestero" id="party-image">
                            <p id="party-name"></p>
                            <button class="dropdown-toggle" data-category="party"
                                onclick="toggleDropdown('party')">Seleccionar Perfume</button>
                            <select id="party-perfume" hidden></select>
                            <div id="party-dropdown" class="dropdown"></div>
                        </div>
                    </div>
                    <div class="combo-item">
                        <h3>Regalo</h3>
                        <div class="combo-selection">
                            <img src="imagenes/depositphotos_82350542-stock-photo-beautiful-gold-present-box-with.jpg" alt="Regalo" id="gift-image">
                            <p id="gift-name"></p>
                            <button class="dropdown-toggle" data-category="gift"
                                onclick="toggleDropdown('gift')">Seleccionar Regalo</button>
                            <select id="gift-perfume" hidden></select>
                            <div id="gift-dropdown" class="dropdown"></div>
                        </div>
                    </div>
                </div>
                <div class="total">
                    <p id="savings" style="color: green;">Estás ahorrando: $0.00</p>
                    <h3>Total: $<span id="total-price">0.00</span></h3>
                </div>
                <div class="whatsapp-button">
                    <a id="whatsapp-link" class="disabled" href="javascript:void(0);">Selecciona tres perfumes y el
                        regalo para
                        continuar</a>
                </div>
            </div>
        </section>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const whatsappLink = document.getElementById('whatsapp-link');

            const perfumes = {
                daily: [
                    { name: 'Dolce&Gabbana K EDT 100ml', image: 'imagenes/fotos-catalogo/d&g/30494500000.png', price: 95 },
                    { name: 'Dolce&Gabbana Light Blue Pour Homme EDT 100ml', image: 'imagenes/fotos-catalogo/d&g/MainSpecs-JPG-2000x2000 - px-LB-PH-200 (1).png', price: 102 },
                    { name: 'Adolfo Dominguez Agua Fresca Lima Tonka EDT 100ml', image: 'imagenes/fotos-catalogo/adolfo/Untitled.jpg', price: 44 },
                    { name: 'Adolfo Dominguez Agua Fresca Citrus Cedro EDT 100ml', image: 'imagenes/fotos-catalogo/adolfo/Untitled-1.jpg', price: 44 },
                    { name: 'Rabanne Phantom EDT 100ml', image: 'imagenes/fotos-catalogo/paco/Untitled.jpg', price: 100 },
                ],
                formal: [
                    { name: 'Givenchy Gentleman EDT Intense 100ml', image: 'imagenes/fotos-catalogo/givenchy/Untitled-3.jpg', price: 91 },
                    { name: 'Givenchy Gentleman Society EDP Extreme 100ml', image: 'imagenes/fotos-catalogo/givenchy/SOCI.png', price: 140 },
                    { name: 'Givenchy Gentleman Society EDP 100ml', image: 'imagenes/fotos-catalogo/givenchy/Untitled-2.jpg', price: 120 },
                    { name: 'Moncler Pour Homme 100ml', image: 'imagenes/fotos-catalogo/moncler/Untitled-1.jpg', price: 147 },
                    { name: 'Dolce&Gabbana The One Pour Homme 100ml', image: 'imagenes/fotos-catalogo/d&g/[30200000308] Perfume para Caballero Eau de Toilette Dolce & Gabbana The One 100ml.png', price: 138 },
                ],
                party: [
                    { name: 'Carolina Herrera Bad Boy Extreme 100ml', image: 'imagenes/fotos-catalogo/ch/Untitled.jpg', price: 108 },
                    { name: 'Carolina Herrera Bad Boy Le Parfum 100ml', image: 'imagenes/fotos-catalogo/ch/Untitled.png', price: 110 },
                    { name: 'AFNAN 9PM 100ml', image: 'imagenes/fotos-catalogo/afnan/Nuoc-Hoa-Nam-Afnan-9PM-pr.webp', price: 60 },
                    { name: 'Rabanne One Million Royal 100ml', image: 'imagenes/fotos-catalogo/paco/65190440_00.png', price: 110 },
                ],
                gift: [
                    { name: 'Waka', image: 'imagenes/soproPA600_fa505239-c929-4b5a-af51-d47d3b311967_1024x1024@2x.webp', price: 0 },
                    { name: 'Boxer', image: 'imagenes/boxer.jpg', price: 0 },
                    { name: 'Vela aromática (By Evermore)', image: 'imagenes/vela.jpeg', price: 0 },
                ]
            };

            function getDiscountedPrice(originalPrice, discountPercentage) {
                return originalPrice - (originalPrice * (discountPercentage / 100));
            }

            function closeAllDropdowns() {
                const dropdowns = document.querySelectorAll('.dropdown');
                dropdowns.forEach(dropdown => {
                    dropdown.classList.remove('show');
                });
            }

            function toggleDropdown(category) {
                closeAllDropdowns();
                const dropdown = document.getElementById(`${category}-dropdown`);
                if (dropdown) {
                    dropdown.classList.add('show');
                }
            }

            function selectPerfume(category, perfume) {
                // Actualizar la imagen del perfume seleccionado
                document.getElementById(`${category}-image`).src = perfume.image;

                // Actualizar el nombre del perfume seleccionado
                document.getElementById(`${category}-name`).innerText = perfume.name;

                // Obtener el elemento de selección
                const selectElement = document.getElementById(`${category}-perfume`);

                // Limpiar todas las opciones existentes
                while (selectElement.options.length > 0) {
                    selectElement.remove(0);
                }

                // Añadir el perfume seleccionado como una opción
                const option = document.createElement('option');
                option.value = perfume.name;
                option.text = perfume.name;
                option.setAttribute('data-price', perfume.price);
                option.setAttribute('data-discounted-price', getDiscountedPrice(perfume.price, 20));
                option.setAttribute('data-image', perfume.image);
                selectElement.appendChild(option);

                // Establecer el valor del elemento de selección al perfume seleccionado
                selectElement.value = perfume.name;

                // Actualizar el total
                updateTotal();

                // Cerrar el dropdown
                closeAllDropdowns();
            }

            // Función para poblar los dropdowns con los perfumes
            function populateDropdown(category) {
                const dropdown = document.getElementById(`${category}-dropdown`);
                dropdown.innerHTML = ''; // Clear existing items
                perfumes[category].forEach(perfume => {
                    const item = document.createElement('div');
                    item.className = 'dropdown-item';
                    item.innerHTML = `<img src="${perfume.image}" alt="${perfume.name}"><p>${perfume.name}</p>`;
                    item.setAttribute('data-price', perfume.price);
                    item.setAttribute('data-discounted-price', getDiscountedPrice(perfume.price, 20));
                    item.setAttribute('data-image', perfume.image);
                    item.onclick = () => selectPerfume(category, perfume);
                    dropdown.appendChild(item);
                });
            }

            function updateWhatsAppLink() {
                const dailySelect = document.getElementById('daily-perfume');
                const formalSelect = document.getElementById('formal-perfume');
                const partySelect = document.getElementById('party-perfume');
                const giftSelect = document.getElementById('gift-perfume');

                const dailyPerfume = dailySelect ? dailySelect.options[dailySelect.selectedIndex].value : "";
                const formalPerfume = formalSelect ? formalSelect.options[formalSelect.selectedIndex].value : "";
                const partyPerfume = partySelect ? partySelect.options[partySelect.selectedIndex].value : "";
                const gift = giftSelect ? giftSelect.options[giftSelect.selectedIndex].value : "";

                const message = `Hola, me gustaría ordenar el combo personalizado con los siguientes perfumes:
- Uso diario: ${dailyPerfume}
- Formal: ${formalPerfume}
- Fiestero: ${partyPerfume}
- Regalo: ${gift}`;

                whatsappLink.href = `https://wa.me/78064327?text=${encodeURIComponent(message)}`;
                console.log('WhatsApp link updated:', whatsappLink.href);
            }

            function updateTotal() {
                let total = 0;
                let originalTotal = 0;
                let selectedCount = 0;
                ['daily', 'formal', 'party', 'gift'].forEach(category => {
                    const selectElement = document.getElementById(`${category}-perfume`);
                    if (selectElement && selectElement.options.length > 0) {
                        const selectedOption = selectElement.options[selectElement.selectedIndex];
                        const price = parseFloat(selectedOption.getAttribute('data-price'));
                        const discountedPrice = parseFloat(selectedOption.getAttribute('data-discounted-price'));
                        if (!isNaN(discountedPrice)) {
                            total += discountedPrice;
                            originalTotal += price;
                            selectedCount++;
                        }
                    }
                });

                const savings = originalTotal - total;
                document.getElementById('total-price').innerText = total.toFixed(2);
                document.getElementById('savings').innerText = `Estás ahorrando: $${savings.toFixed(2)}`;
                whatsappCount(selectedCount);
            }

            function whatsappCount(selectedCount) {
                if (selectedCount === 4) {
                    whatsappLink.classList.remove('disabled');
                    whatsappLink.innerText = 'Ordenar por WhatsApp';
                    updateWhatsAppLink();
                } else {
                    whatsappLink.classList.add('disabled');
                    whatsappLink.innerText = 'Selecciona tres perfumes para continuar';
                    whatsappLink.removeAttribute('href');
                }
            }

            document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
                toggle.addEventListener('click', (event) => {
                    event.stopPropagation();
                    toggleDropdown(event.currentTarget.dataset.category);
                });
            });

            document.addEventListener('click', (event) => {
                if (!event.target.classList.contains('dropdown-toggle')) {
                    closeAllDropdowns();
                }
            });

            populateDropdown('daily');
            populateDropdown('formal');
            populateDropdown('party');
            populateDropdown('gift');
            updateTotal();
        });
    </script>
    <div data-include="footer.html">
        < /div>
            <script src="js/scripts.js"></script>
            <script src="js/include.js"></script>
</body>
</html>